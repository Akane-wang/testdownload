import{_ as I,Q as F,s as T,S as K,X as G,i as J,C as z,T as Q,R as Z}from"./common-Dm6tZ4tm.js";import{N as j,O as ee,P as te,Q as $,R as se,M as ae}from"./index-KJCVFZLl.js";import{a as Y,o as U,r as k,e as L,g as w,h as X,j as r,c as i,t as _,f as c,i as N,k as x,p,F as A,ar as O,w as le,M as ne,as as ie,al as oe,K as re,at as P}from"./index-BbMxaTsX.js";const ue={style:{margin:"1vw 0",padding:"0 1vw"}},de={__name:"tepmCheck",props:{value:{type:Object,default:()=>({})}},setup(g){const f=g,v=Y({get(){return f.value||{}},set(l){console.log("set",l),emits("update:value",l)}});U(()=>{t(),s()});const e=k([]);function t(){F({typeCode:"DEFECTS_FLAG"}).then(l=>{l&&(l.data&&l.code===0?e.value=l.data.map(d=>({label:d.valTc,value:d.code})):e.value=[])}).catch(l=>{T({message:l.msg,type:"fail"})})}const a=k([]);function s(){F({typeCode:"CHECK_LOCATION_TYPE"}).then(l=>{l&&(l.data&&l.code===0?a.value=l.data.map(d=>({label:d.valTc,value:d.code})):a.value=[])}).catch(l=>{T({message:l.msg,type:"fail"})})}return(l,d)=>{const n=j,o=ee,m=te,b=$;return w(!0),L(A,null,X(v.value,(h,C)=>(w(),L("div",{class:"Piping",key:C},[r("div",null,[r("p",ue,_(h.requirements),1),i(b,{model:h,class:"formTel"},{default:c(()=>[i(n,{label:"Point type分数種類：Penalty Point罰分\r\nDefects/irregularities found?發現不合規格/不妥當之\r\n處？:"},{default:c(()=>[p(_(h.defects),1)]),_:2},1024),i(n,{label:"Defects/irregularities不合规格/不妥當之處:"},{default:c(()=>[p(_(h.defectsDetail),1)]),_:2},1024),i(n,{label:"Type類别:"},{default:c(()=>[p(_(h.waterType),1)]),_:2},1024),i(n,{label:"Details of Inspected Location已視察位置的詳情:"},{default:c(()=>[p(_(h.inspectLocation),1)]),_:2},1024),i(n,{label:"Details詳情:"},{default:c(()=>[p(_(h.details),1)]),_:2},1024),i(n,{label:"Remarks備註:"},{default:c(()=>[p(_(h.remarks),1)]),_:2},1024),i(n,{label:"Photo Taken夹附图片:"},{default:c(()=>[i(o,{modelValue:h.potoTaken,"onUpdate:modelValue":B=>h.potoTaken=B,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),h.potoTaken?(w(),N(m,{key:0,disabled:"",modelValue:h.file,"onUpdate:modelValue":B=>h.file=B,"after-read":()=>l.afterRead(l.file,h),"before-delete":(B,y)=>l.deletefile(B,y,h)},null,8,["modelValue","onUpdate:modelValue","after-read","before-delete"])):x("",!0)]),_:2},1032,["model"])])]))),128)}}},D=I(de,[["__scopeId","data-v-886e0c5f"]]),ce={class:"manifestHeader"},ve={key:0},fe={key:1},me={key:2},he={key:3},pe={key:4},ge={__name:"formOfChecklist",props:{value:{type:Object,default:()=>({})}},setup(g){const f=O();U(()=>{e(),a(),d()});const v=k([]);function e(){F({typeCode:"INSPECTION_TYPE"}).then(n=>{n&&(n.data&&n.code===0?v.value=n.data.map(o=>({label:o.valTc,value:o.code})):v.value=[])}).catch(n=>{T({message:n.msg,type:"fail"})})}const t=k([]);function a(){F({typeCode:"PLUMBING_WORK_TYPE"}).then(n=>{n&&(n.data&&n.code===0?t.value=n.data.map(o=>({label:o.valTc,value:o.code})):t.value=[])}).catch(n=>{T({message:n.msg,type:"fail"})})}const s=k({}),l=k({});function d(){K({formId:f.query.formId,refId:f.query.refId,unPassed:!0}).then(n=>{var o;n&&n.data&&n.code===0&&(l.value=n.data,s.value=n.data.cklstHeader,s.value.premisesAddress="",(o=n.data.cklstHeader)!=null&&o.addrLine1&&(s.value.premisesAddress+="Premises Address line 1\n",s.value.premisesAddress+=n.data.cklstHeader.addrLine1),n.data.cklstHeader.addrLine2&&(s.value.premisesAddress+="Premises Address line 2\n",s.value.premisesAddress+=n.data.cklstHeader.addrLine2),n.data.cklstHeader.addrLine3&&(s.value.premisesAddress+="Premises Address line 3\n",s.value.premisesAddress+=n.data.cklstHeader.addrLine3),n.data.cklstHeader.addrLine4&&(s.value.premisesAddress+="Premises Address line 4\n",s.value.premisesAddress+=n.data.cklstHeader.addrLine4),["cklstBodyAList","cklstBodyBList","cklstBodyCList","cklstBodyDList","cklstBodyEList"].forEach(m=>{l.value[m]&&l.value[m].forEach(b=>{b.potoTaken=="N"?b.potoTaken=!1:b.potoTaken=="Y"&&(b.potoTaken=!0,b.file=[],b.potoIdUrl.forEach(h=>{b.file.push({url:h+=".jpeg"})}))})}))}).catch(n=>{T({message:n.msg,type:"fail"})})}return(n,o)=>{const m=j,b=$;return w(),L(A,null,[r("div",ce,[o[5]||(o[5]=r("p",{class:"title"},"General Information一般資料",-1)),i(b,{model:s.value,class:"formTel"},{default:c(()=>[i(m,{label:"Date of Inspection 視察日期:"},{default:c(()=>[p(_(s.value.inspectDate),1)]),_:1}),i(m,{label:"Premises Address 處所地址:"},{default:c(()=>[p(_(s.value.premisesAddress),1)]),_:1}),i(m,{label:"Name of Licensed Plumber 持牌水喉匠姓名:"},{default:c(()=>[p(_(s.value.lpName),1)]),_:1}),i(m,{label:"Plumber's Licence Number 水喉匠牌照號碼:"},{default:c(()=>[p(_(s.value.lpNo),1)]),_:1}),i(m,{label:"Serial Number of Form WWO46 表格WWO46編號:"},{default:c(()=>[p(_(s.value.refId),1)]),_:1}),i(m,{label:"Inspection Type 視察類別:"},{default:c(()=>[p(_(s.value.inspectType),1)]),_:1}),i(m,{label:"Type of Plumbing Works水管工程類别:"},{default:c(()=>[p(_(s.value.waterPipeType),1)]),_:1}),i(m,{label:"ASN申請書编號:"},{default:c(()=>[p(_(s.value.input),1)]),_:1})]),_:1},8,["model"])]),l.value.cklstBodyAList&&l.value.cklstBodyAList.length>0?(w(),L("div",ve,[o[6]||(o[6]=r("p",{class:"rowTitle"}," (A)Piping (including all pipes and fittings,and connection pipe) 喉管（包括所有喉管與装置，以及接駁喉） ",-1)),i(D,{value:l.value.cklstBodyAList,"onUpdate:value":o[0]||(o[0]=h=>l.value.cklstBodyAList=h)},null,8,["value"])])):x("",!0),l.value.cklstBodyBList&&l.value.cklstBodyBList.length>0?(w(),L("div",fe,[o[7]||(o[7]=r("p",{class:"rowTitle"},"(B) 表位/检测表位",-1)),i(D,{value:l.value.cklstBodyBList,"onUpdate:value":o[1]||(o[1]=h=>l.value.cklstBodyBList=h)},null,8,["value"])])):x("",!0),l.value.cklstBodyCList&&l.value.cklstBodyCList.length>0?(w(),L("div",me,[o[8]||(o[8]=r("p",{class:"rowTitle"},"(C) 储水缸",-1)),i(D,{value:l.value.cklstBodyCList,"onUpdate:value":o[2]||(o[2]=h=>l.value.cklstBodyCList=h)},null,8,["value"])])):x("",!0),l.value.cklstBodyDList&&l.value.cklstBodyDList.length>0?(w(),L("div",he,[o[9]||(o[9]=r("p",{class:"rowTitle"},"(D) 同位更换水喉",-1)),i(D,{value:l.value.cklstBodyDList,"onUpdate:value":o[3]||(o[3]=h=>l.value.cklstBodyDList=h)},null,8,["value"])])):x("",!0),l.value.cklstBodyEList&&l.value.cklstBodyEList.length>0?(w(),L("div",pe,[o[10]||(o[10]=r("p",{class:"rowTitle"},"(E) 其他",-1)),i(D,{value:l.value.cklstBodyEList,"onUpdate:value":o[4]||(o[4]=h=>l.value.cklstBodyEList=h)},null,8,["value"])])):x("",!0)],64)}}},ye=I(ge,[["__scopeId","data-v-1b1c3fa6"]]),we={style:{margin:"1vw 0",padding:"0 1vw"}},_e={__name:"tepmTesRecords",props:{value:{type:Object,default:()=>({})}},setup(g){const f=g,v=Y({get(){return f.value||{}},set(e){console.log("set",e),emits("update:value",e)}});return U(()=>{}),(e,t)=>{const a=j,s=$;return w(!0),L(A,null,X(v.value,(l,d)=>(w(),L("div",{class:"Piping",key:d},[r("div",null,[r("p",we,_(l.requirements),1),i(s,{model:l,class:"formTel"},{default:c(()=>[i(a,{label:"Location of Joint:"},{default:c(()=>[p(_(l.joint),1)]),_:2},1024),i(a,{label:"Pass / Fail:"},{default:c(()=>[p(_(l.isPass=="Y"?"通过":"未通过"),1)]),_:2},1024),i(a,{label:"Photo Ref:"},{default:c(()=>[p(_(l.photoRef),1)]),_:2},1024)]),_:2},1032,["model"])])]))),128)}}},E=I(_e,[["__scopeId","data-v-54ae01c1"]]),be={class:"manifestHeader"},Le={key:0},ke={key:1},Se={key:2},xe={key:3},Ce={key:4},Be={__name:"formOfTesRecords",props:{value:{type:Object,default:()=>({})}},setup(g){const f=O();U(()=>{t()});const v=k({}),e=k({});function t(){G({formId:f.query.formId,refId:f.query.refId,unPassed:!0}).then(a=>{a&&a.data&&a.code===0&&(e.value=a.data,v.value=a.data.sdrjtstsHeader)}).catch(a=>{T({message:a.msg,type:"fail"})})}return(a,s)=>{const l=j,d=$;return w(),L(A,null,[r("div",be,[s[5]||(s[5]=r("p",{class:"title"},"Solder Joint Sampling Testing Records",-1)),i(d,{model:v.value,class:"formTel"},{default:c(()=>[i(l,{label:"Name of Building:"},{default:c(()=>[p(_(v.value.buildingName),1)]),_:1}),i(l,{label:"No of Storey:"},{default:c(()=>[p(_(v.value.storey),1)]),_:1}),i(l,{label:"WSD ref:"},{default:c(()=>[p(_(v.value.wsdRef),1)]),_:1}),i(l,{label:"ASN:"},{default:c(()=>[p(_(v.value.asnNo),1)]),_:1}),i(l,{label:"Date:"},{default:c(()=>[p(_(v.value.date),1)]),_:1}),i(l,{label:"Date Remarks 日期備註:"},{default:c(()=>[p(_(v.value.remarks),1)]),_:1})]),_:1},8,["model"])]),e.value.sdrjtstsBodyAList&&e.value.sdrjtstsBodyAList.length>0?(w(),L("div",Le,[s[6]||(s[6]=r("p",{class:"rowTitle"}," (A) ",-1)),i(E,{value:e.value.sdrjtstsBodyAList,"onUpdate:value":s[0]||(s[0]=n=>e.value.sdrjtstsBodyAList=n)},null,8,["value"])])):x("",!0),e.value.sdrjtstsBodyBList&&e.value.sdrjtstsBodyBList.length>0?(w(),L("div",ke,[s[7]||(s[7]=r("p",{class:"rowTitle"},"(B) ",-1)),i(E,{value:e.value.sdrjtstsBodyBList,"onUpdate:value":s[1]||(s[1]=n=>e.value.sdrjtstsBodyBList=n)},null,8,["value"])])):x("",!0),e.value.sdrjtstsBodyCList&&e.value.sdrjtstsBodyCList.length>0?(w(),L("div",Se,[s[8]||(s[8]=r("p",{class:"rowTitle"},"(C) ",-1)),i(E,{value:e.value.sdrjtstsBodyCList,"onUpdate:value":s[2]||(s[2]=n=>e.value.sdrjtstsBodyCList=n)},null,8,["value"])])):x("",!0),e.value.sdrjtstsBodyDList&&e.value.sdrjtstsBodyDList.length>0?(w(),L("div",xe,[s[9]||(s[9]=r("p",{class:"rowTitle"},"(D) ",-1)),i(E,{value:e.value.sdrjtstsBodyDList,"onUpdate:value":s[3]||(s[3]=n=>e.value.sdrjtstsBodyDList=n)},null,8,["value"])])):x("",!0),e.value.sdrjtstsBodyEList&&e.value.sdrjtstsBodyEList.length>0?(w(),L("div",Ce,[s[10]||(s[10]=r("p",{class:"rowTitle"},"(E) ",-1)),i(E,{value:e.value.sdrjtstsBodyEList,"onUpdate:value":s[4]||(s[4]=n=>e.value.sdrjtstsBodyEList=n)},null,8,["value"])])):x("",!0)],64)}}},Te=I(Be,[["__scopeId","data-v-38c5a744"]]);function W(g){"@babel/helpers - typeof";return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(f){return typeof f}:function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},W(g)}function De(g,f){if(!(g instanceof f))throw new TypeError("Cannot call a class as a function")}function Ee(g,f){for(var v=0;v<f.length;v++){var e=f[v];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(g,Ie(e.key),e)}}function We(g,f,v){return f&&Ee(g.prototype,f),Object.defineProperty(g,"prototype",{writable:!1}),g}function Ie(g){var f=Ue(g,"string");return W(f)=="symbol"?f:f+""}function Ue(g,f){if(W(g)!="object"||!g)return g;var v=g[Symbol.toPrimitive];if(v!==void 0){var e=v.call(g,f);if(W(e)!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(g)}var Ae=/Android|iPhone|iPad|Mobile/i.test(navigator.userAgent),Re=function(){function g(f,v){var e=this;De(this,g),this.canvas={},this.ctx={},this.width=320,this.height=200,this.scale=window.devicePixelRatio||1,this.color="black",this.bgColor="",this.canDraw=!1,this.openSmooth=!0,this.minWidth=2,this.maxWidth=6,this.minSpeed=1.5,this.maxWidthDiffRate=20,this.points=[],this.undoList=[],this.redoList=[],this.onStart=function(){},this.onEnd=function(){},this.addListener=function(){e.removeListener(),e.canvas.style.touchAction="none",Ae&&("ontouchstart"in window||navigator.maxTouchPoints)?(e.canvas.addEventListener("touchstart",e.onDrawStart,{passive:!1}),e.canvas.addEventListener("touchmove",e.onDrawMove,{passive:!1}),document.addEventListener("touchcancel",e.onDrawEnd,{passive:!1}),document.addEventListener("touchend",e.onDrawEnd,{passive:!1})):(e.canvas.addEventListener("mousedown",e.onDrawStart),e.canvas.addEventListener("mousemove",e.onDrawMove),document.addEventListener("mouseup",e.onDrawEnd))},this.removeListener=function(){e.canvas.style.touchAction="auto",e.canvas.removeEventListener("touchstart",e.onDrawStart),e.canvas.removeEventListener("touchmove",e.onDrawMove),document.removeEventListener("touchend",e.onDrawEnd),document.removeEventListener("touchcancel",e.onDrawEnd),e.canvas.removeEventListener("mousedown",e.onDrawStart),e.canvas.removeEventListener("mousemove",e.onDrawMove),document.removeEventListener("mouseup",e.onDrawEnd)},this.onDrawStart=function(t){t.preventDefault(),e.canDraw=!0,e.initPoint(t),e.onStart&&e.onStart(t)},this.onDrawMove=function(t){if(t.preventDefault(),!!e.canDraw&&(e.initPoint(t),!(e.points.length<2))){var a=e.points.slice(-1)[0],s=e.points.slice(-2,-1)[0];window.requestAnimationFrame?window.requestAnimationFrame(function(){return e.onDraw(s,a)}):e.onDraw(s,a)}},this.onDraw=function(t,a){e.ctx.strokeStyle=a.color||e.color,e.openSmooth?e.drawSmoothLine(t,a):e.drawNoSmoothLine(t,a)},this.onDrawEnd=function(t){e.canDraw&&(e.undoList.push(e.points),e.redoList=[],e.canDraw=!1,e.points=[],e.onEnd&&e.onEnd(t))},this.getLineWidth=function(t){var a=e.minSpeed>10?10:e.minSpeed<1?1:e.minSpeed,s=(e.maxWidth-e.minWidth)*t/a,l=Math.max(e.maxWidth-s,e.minWidth);return Math.min(l,e.maxWidth)},this.getRadianData=function(t,a,s,l){var d=s-t,n=l-a;if(d===0)return{val:0,pos:-1};if(n===0)return{val:0,pos:1};var o=Math.abs(Math.atan(n/d));return s>t&&l<a||s<t&&l>a?{val:o,pos:1}:{val:o,pos:-1}},this.getRadianPoints=function(t,a,s,l){if(t.val===0)return t.pos===1?[{x:a,y:s+l},{x:a,y:s-l}]:[{y:s,x:a+l},{y:s,x:a-l}];var d=Math.sin(t.val)*l,n=Math.cos(t.val)*l;return t.pos===1?[{x:a+d,y:s+n},{x:a-d,y:s-n}]:[{x:a+d,y:s-n},{x:a-d,y:s+n}]},this.initPoint=function(t){var a=Date.now(),s=e.points.slice(-1)[0];if(!(s&&s.t===a)){var l=e.canvas.getBoundingClientRect(),d=t.touches&&t.touches[0]||t,n=d.clientX-l.left,o=d.clientY-l.top;if(!(s&&s.x===n&&s.y===o)){var m={x:n,y:o,t:a,color:e.color};if(e.openSmooth&&s){var b=e.points.slice(-2,-1)[0];if(m.distance=Math.sqrt(Math.pow(m.x-s.x,2)+Math.pow(m.y-s.y,2)),m.speed=m.distance/(m.t-s.t||.1),m.lineWidth=e.getLineWidth(m.speed),b&&b.lineWidth&&s.lineWidth){var h=(m.lineWidth-s.lineWidth)/s.lineWidth,C=e.maxWidthDiffRate/100;if(C=C>1?1:C<.01?.01:C,Math.abs(h)>C){var B=h>0?C:-C;m.lineWidth=s.lineWidth*(1+B)}}}e.points.push(m)}}},this.drawSmoothLine=function(t,a){var s=a.x-t.x,l=a.y-t.y;if(Math.abs(s)+Math.abs(l)<=e.scale?(a.lastX1=a.lastX2=t.x+s*.5,a.lastY1=a.lastY2=t.y+l*.5):(a.lastX1=t.x+s*.3,a.lastY1=t.y+l*.3,a.lastX2=t.x+s*.7,a.lastY2=t.y+l*.7),a.perLineWidth=(t.lineWidth+a.lineWidth)/2,typeof t.lastX1=="number"){if(e.drawCurveLine(t.lastX2,t.lastY2,t.x,t.y,a.lastX1,a.lastY1,a.perLineWidth),t.isFirstPoint||t.lastX1===t.lastX2&&t.lastY1===t.lastY2)return;var d=e.getRadianData(t.lastX1,t.lastY1,t.lastX2,t.lastY2),n=e.getRadianPoints(d,t.lastX1,t.lastY1,t.perLineWidth/2),o=e.getRadianPoints(d,t.lastX2,t.lastY2,a.perLineWidth/2);e.drawTrapezoid(n[0],o[0],o[1],n[1],a.color)}else a.isFirstPoint=!0},this.drawNoSmoothLine=function(t,a){a.lastX=t.x+(a.x-t.x)*.5,a.lastY=t.y+(a.y-t.y)*.5,typeof t.lastX=="number"&&e.drawCurveLine(t.lastX,t.lastY,t.x,t.y,a.lastX,a.lastY,e.maxWidth)},this.drawCurveLine=function(t,a,s,l,d,n,o){e.ctx.lineWidth=Number(o.toFixed(1)),e.ctx.beginPath(),e.ctx.moveTo(Number(t.toFixed(1)),Number(a.toFixed(1))),e.ctx.quadraticCurveTo(Number(s.toFixed(1)),Number(l.toFixed(1)),Number(d.toFixed(1)),Number(n.toFixed(1))),e.ctx.stroke()},this.drawTrapezoid=function(t,a,s,l,d){e.ctx.beginPath(),e.ctx.moveTo(Number(t.x.toFixed(1)),Number(t.y.toFixed(1))),e.ctx.lineTo(Number(a.x.toFixed(1)),Number(a.y.toFixed(1))),e.ctx.lineTo(Number(s.x.toFixed(1)),Number(s.y.toFixed(1))),e.ctx.lineTo(Number(l.x.toFixed(1)),Number(l.y.toFixed(1))),e.ctx.fillStyle=d||e.color,e.ctx.fill()},this.drawBgColor=function(){e.bgColor&&(e.ctx.fillStyle=e.bgColor,e.ctx.fillRect(0,0,e.width,e.height))},this.drawByImageUrl=function(t){var a=new Image;a.onload=function(){e.ctx.clearRect(0,0,e.width,e.height),e.ctx.drawImage(a,0,0,e.width,e.height)},a.crossOrigin="anonymous",a.src=t},this.clear=function(){e.ctx.clearRect(0,0,e.width,e.height),e.drawBgColor(),e.undoList=[],e.redoList=[]},this.undo=function(){if(e.undoList.length){var t=e.undoList.pop();t&&e.redoList.unshift(t),e.ctx.clearRect(0,0,e.width,e.height),e.drawBgColor(),e.undoList.forEach(function(a){a.forEach(function(s,l){l!==0&&e.onDraw(a[l-1],s)})})}},this.redo=function(){if(e.redoList.length){var t=e.redoList.shift();t&&e.undoList.push(t),e.ctx.clearRect(0,0,e.width,e.height),e.drawBgColor(),e.undoList.forEach(function(a){a.forEach(function(s,l){l!==0&&e.onDraw(a[l-1],s)})})}},this.toDataURL=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"image/png",a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(e.canvas.width===e.width)return e.canvas.toDataURL(t,a);var s=document.createElement("canvas");s.width=e.width,s.height=e.height;var l=s.getContext("2d");return l.drawImage(e.canvas,0,0,s.width,s.height),s.toDataURL(t,a)},this.getPNG=function(){return e.toDataURL()},this.getJPG=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.8;return e.toDataURL("image/jpeg",t)},this.isEmpty=function(){var t=document.createElement("canvas"),a=t.getContext("2d");return t.width=e.canvas.width,t.height=e.canvas.height,e.bgColor?(a.fillStyle=e.bgColor,a.fillRect(0,0,t.width,t.height)):e.scale!==1&&a.scale(e.scale,e.scale),t.toDataURL()===e.canvas.toDataURL()},this.getRotateCanvas=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:90;t>0?t=t>90?180:90:t=t<-90?180:-90;var a=document.createElement("canvas"),s=e.width,l=e.height;t===180?(a.width=s,a.height=l):(a.width=l,a.height=s);var d=a.getContext("2d");return d.rotate(t*Math.PI/180),t===90?d.drawImage(e.canvas,0,-l,s,l):t===-90?d.drawImage(e.canvas,-s,0,s,l):t===180&&d.drawImage(e.canvas,-s,-l,s,l),a},this.init(f,v)}return We(g,[{key:"init",value:function(v){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};v&&(this.canvas=v,this.ctx=v.getContext("2d"),this.width=e.width||v.clientWidth||this.width,this.height=e.height||v.clientHeight||this.height,this.scale=e.scale||this.scale,this.color=e.color||this.color,this.bgColor=e.bgColor||this.bgColor,this.openSmooth=e.openSmooth===void 0?this.openSmooth:!!e.openSmooth,this.minWidth=e.minWidth||this.minWidth,this.maxWidth=e.maxWidth||this.maxWidth,this.minSpeed=e.minSpeed||this.minSpeed,this.maxWidthDiffRate=e.maxWidthDiffRate||this.maxWidthDiffRate,this.onStart=e.onStart,this.onEnd=e.onEnd,this.scale>0&&(this.canvas.height=this.height*this.scale,this.canvas.width=this.width*this.scale,this.scale!==1&&(this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.ctx.scale(this.scale,this.scale))),this.ctx.lineCap="round",this.drawBgColor(),this.addListener())}}]),g}();const Ne={class:"sign-finish"},Fe={class:"wrap2"},je={class:"actionsWrap"},$e={class:"actions"},Me={key:0},Oe={key:1},Pe={__name:"signature",props:{curShowImgSrc:{type:[String],default:""}},emits:["toggleshowSignature"],setup(g,{emit:f}){const v=f,e=g,t=k(null),a=k(null),s=k(!1);U(()=>{l()});function l(){const h=t.value,C={width:window.innerWidth-120,height:window.innerHeight-80,minWidth:3,maxWidth:10,openSmooth:!0,bgColor:"#f6f6f6"};a.value=new Re(h,C),console.log("mounted",a.value),e.curShowImgSrc&&(a.value.drawByImageUrl(e.curShowImgSrc),setTimeout(()=>{const B=a.value.getRotateCanvas(90);console.log("canvas",B);const y=B.toDataURL();console.log("pngUrl",y),a.value.drawByImageUrl(y),s.value=!0},20))}function d(){a.value.clear()}function n(){a.value.undo()}function o(){if(a.value.isEmpty()){alert("isEmpty");return}const B=a.value.getRotateCanvas(-90).toDataURL();t.value.toBlob(y=>{const u=new File([y],"signature.png",{type:"image/png",lastModified:Date.now()});console.log("blob",u),v("toggleshowSignature",{pngUrl:B,file:u})},"image/png",.8)}function m(){s.value=!1,a.value.clear()}function b(){v("toggleshowSignature")}return(h,C)=>(w(),L("div",Ne,[r("div",Fe,[r("div",je,[r("div",$e,[s.value?x("",!0):(w(),L("div",Me,[r("button",{class:"danger",onClick:d},"清除"),r("button",{class:"warning",onClick:n},"撤销"),r("button",{class:"success",onClick:o},"保存")])),s.value?(w(),L("div",Oe,[r("button",{class:"warning",onClick:m},"重签"),r("button",{class:"success",onClick:b},"确认")])):x("",!0)])]),r("canvas",{class:"canvas",ref_key:"canvasRef",ref:t},null,512)])]))}},Ye={class:"contentBox"},Xe={class:"signatureBox"},qe={class:"box"},He={class:"info"},Ve={key:0},Ke=["src"],Ge={class:"signatureBox",style:{"margin-top":"2vh"}},Je={class:"box"},ze={class:"info"},Qe={key:0},Ze=["src"],et={class:"footer"},tt={style:{"text-align":"center",padding:"5vw 0px 5vw 0"}},st={__name:"index",setup(g){const f=k("#1074cc"),v=O(),e=k(null),t=k(""),a=k({send:!1}),s=k({formId:v.query.formId,isCompleted:!0,cklstFooter:{}});le(()=>v,()=>{switch(console.log("watch",v.query.type),v.query.type){case"AWS_INSP_CKLST":t.value=P(ye);break;case"AWS_SDRJT_TST":t.value=P(Te);break}},{immediate:!0,deep:!0});const l=k(!1);k(!1);const d=k(""),n=k("");function o(y){y=="wSDep"?m.value.pngUrl?(d.value=m.value.pngUrl,l.value=!0):(n.value=y,l.value=!0):y=="lp"&&(b.value.pngUrl?(d.value=b.value.pngUrl,l.value=!0):(n.value=y,l.value=!0))}const m=k(""),b=k("");function h(y){l.value=!l.value,n.value=="wSDep"&&y?(m.value=y,C("wSDep",m.value.file)):n.value=="lp"&&y&&(b.value=y,C("lp",b.value.file)),setTimeout(()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},100),d.value=""}function C(y,u){const R=new FormData;console.log("signatureUrlOfWsdObj",m),R.append("file",u),Z(R).then(S=>{S&&S.data&&S.code===0&&(y=="wSDep"?s.value.cklstFooter.wsdSignId=S.data.fileId:y=="lp"&&(s.value.cklstFooter.lpSignId=S.data.fileId))}).catch(S=>{console.log(S),T({message:S.msg,type:"fail"})})}function B(){console.log("requestObj",s.value),Q(s.value).then(y=>{y&&y.data&&y.code===0&&T({message:y.msg,type:"success"})}).catch(y=>{console.log(y),T({message:y.msg,type:"fail"})})}return(y,u)=>{const R=J,S=oe("P"),q=ae,H=z,V=se;return w(),L(A,null,[r("div",{class:re({he100:l.value})},[i(R,{title:"Form Preview",back:!0,bgColor:f.value},null,8,["bgColor"]),r("div",Ye,[(w(),N(ie,null,[(w(),N(ne(t.value),{ref:"currentComponentRef"},null,512))],1024)),r("div",Xe,[u[9]||(u[9]=r("p",{class:"title"},"WSD Inspection Staff水務署視察人员",-1)),r("div",qe,[r("div",He,[r("div",null,[i(S,null,{default:c(()=>u[3]||(u[3]=[p("Name姓名： ")])),_:1}),i(S,null,{default:c(()=>u[4]||(u[4]=[p("CHENG Yin King Stella")])),_:1})]),r("div",null,[i(S,null,{default:c(()=>u[5]||(u[5]=[p("Post职位： ")])),_:1}),i(S,null,{default:c(()=>u[6]||(u[6]=[p("ACCMC1")])),_:1})]),r("div",null,[i(S,null,{default:c(()=>u[7]||(u[7]=[p("Date日期： ")])),_:1}),i(S,null,{default:c(()=>u[8]||(u[8]=[p("2023/08/25")])),_:1})])]),r("div",{class:"signature",onClick:u[0]||(u[0]=M=>o("wSDep"))},[m.value.pngUrl?x("",!0):(w(),L("p",Ve,"Signature簽名")),m.value.pngUrl?(w(),L("img",{key:1,src:m.value.pngUrl,alt:""},null,8,Ke)):x("",!0)])])]),r("div",Ge,[u[16]||(u[16]=r("p",{class:"title"},"Licensed Plumber持牌水喉匠",-1)),r("div",Je,[r("div",ze,[r("div",null,[i(S,null,{default:c(()=>u[10]||(u[10]=[p("Name姓名： ")])),_:1}),i(S,null,{default:c(()=>u[11]||(u[11]=[p("CHENG Yin King Stella")])),_:1})]),r("div",null,[i(S,null,{default:c(()=>u[12]||(u[12]=[p("Plumber's Licence No.水喉匠牌照号码： ")])),_:1}),i(S,null,{default:c(()=>u[13]||(u[13]=[p("ACCMC1")])),_:1})]),r("div",null,[i(S,null,{default:c(()=>u[14]||(u[14]=[p("Date日期： ")])),_:1}),i(S,null,{default:c(()=>u[15]||(u[15]=[p("2023/08/25")])),_:1})])]),r("div",{class:"signature",onClick:u[1]||(u[1]=M=>o("lp"))},[b.value.pngUrl?x("",!0):(w(),L("p",Qe,"Signature簽名")),b.value.pngUrl?(w(),L("img",{key:1,src:b.value.pngUrl,alt:""},null,8,Ze)):x("",!0)])])])]),r("div",et,[u[17]||(u[17]=r("div",null,"Send notification email on submission 提交后发送通知电子邮件：",-1)),r("div",null,[i(H,{center:"",title:"star2000_lau@yahoo.com.hk",class:"skip"},{"right-icon":c(()=>[i(q,{modelValue:a.value.send,"onUpdate:modelValue":u[2]||(u[2]=M=>a.value.send=M),size:"16px"},null,8,["modelValue"])]),_:1})])]),r("div",tt,[i(V,{round:"",type:"primary",onClick:B},{default:c(()=>u[18]||(u[18]=[p("Submit Form")])),_:1})])],2),l.value?(w(),N(Pe,{key:0,ref_key:"signatureRef",ref:e,class:"signatureCss",onToggleshowSignature:h,curShowImgSrc:d.value},null,8,["curShowImgSrc"])):x("",!0)],64)}}},it=I(st,[["__scopeId","data-v-f5f04699"]]);export{it as default};
